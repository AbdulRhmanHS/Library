(()=>{"use strict";class e{constructor(e,t,d,n,o,s){this.title=e,this.author=t,this.pages=d,this.color=n,this.read=o,this.id=s}toggleRead(e){this.read?(e.classList.remove("read"),e.classList.add("unread"),this.read=!1):(e.classList.remove("unread"),e.classList.add("read"),this.read=!0)}}const t=e=>(299*parseInt(e.substr(1,2),16)+587*parseInt(e.substr(3,2),16)+114*parseInt(e.substr(5,2),16))/1e3>=128?"black":"white";function d(e,t){const d=e.dataset.id;return t.find(e=>e.id==d)}function n(e,t){const n=d(e,t);e.classList.toggle("book-spine");const o=document.createElement("p");o.textContent=n.title;const s=document.createElement("p");s.classList.add("toggle-read"),s.textContent="R",n.read?s.classList.add("read"):s.classList.add("unread"),s.addEventListener("click",e=>{e.stopPropagation(),n.toggleRead(s)}),e.appendChild(o),e.appendChild(s)}const o=document.querySelector("main"),s=document.querySelector(".book-container"),a=[],i=[],l=document.getElementById("add-book"),c=document.getElementById("cancel-button"),r=document.querySelector("dialog"),u=document.getElementById("add-book-form"),m=document.getElementById("title-text"),p=document.getElementById("author-text"),h=document.getElementById("pages-text");function g(){!function(e,t,d){document.querySelectorAll(".book-shelf").forEach(e=>e.remove());const n=e.clientWidth+10,o=Math.floor(n/45.75);let s;0!==o&&d.forEach((e,d)=>{d%o===0&&(s=document.createElement("div"),s.classList.add("book-shelf"),t.appendChild(s)),s&&s.appendChild(e)})}(o,s,a)}[m,p,h].forEach(e=>{e.addEventListener("input",()=>{e.setCustomValidity("")})}),m.addEventListener("invalid",()=>{m.setCustomValidity("There is no book without a title eeh!")}),p.addEventListener("invalid",()=>{p.setCustomValidity("The book has to be made by someone just like you!")}),h.addEventListener("invalid",()=>{h.setCustomValidity("No empty books!")}),l.addEventListener("click",()=>{r.showModal()}),c.addEventListener("click",e=>{e.preventDefault(),r.close()}),u.addEventListener("submit",o=>{o.preventDefault();const l=document.getElementById("color").value,c=document.getElementById("read").checked;!function(t,d,n,o,s){const a=crypto.randomUUID(),l=new e(t,d,n,o,s,a);i.push(l)}(m.value,p.value,h.value,l,c),function(){const e=document.createElement("div");if(s.lastChild&&"DIV"===s.lastChild.tagName)s.lastChild.appendChild(e);else{const t=document.createElement("div");s.appendChild(t),t.appendChild(e)}a.push(e),e.dataset.id=i[i.length-1].id,g();const o=d(e,i);e.style.backgroundColor=o.color,e.style.color=t(o.color),e.addEventListener("click",o=>{o.target.classList.contains("toggle-read")||function(e,o,s,a){const i=d(e,o);if(e.classList.toggle("book-expanded"),e.classList.contains("book-expanded")){for(;e.firstChild;)e.classList.remove("book-spine"),e.removeChild(e.firstChild);const d=document.createElement("div");d.classList.add("upper-details");const n=document.createElement("p");n.id="title",n.textContent="Title: "+i.title;const l=document.createElement("p");l.id="pages",l.textContent="Pages: "+i.pages;const c=document.createElement("button");c.id="remove-button",c.textContent="X",c.style.color=t(i.color),c.addEventListener("click",()=>{const t=e.dataset.id,d=s.indexOf(e);d>-1&&s.splice(d,1);const n=o.findIndex(e=>e.id==t);n>-1&&o.splice(n,1),e.remove(),a()});const r=document.createElement("div");r.classList.add("lower-details");const u=document.createElement("p");u.classList.add("toggle-read"),u.textContent="R",i.read?u.classList.add("read"):u.classList.add("unread"),u.addEventListener("click",e=>{e.stopPropagation(),i.toggleRead(u)});const m=document.createElement("p");m.textContent="Author: "+i.author,d.appendChild(n),d.appendChild(l),d.appendChild(c),r.appendChild(u),r.appendChild(m),e.appendChild(d),e.appendChild(r)}else if(i){for(;e.firstChild;)e.removeChild(e.firstChild);n(e,o)}}(e,i,a,g)}),n(e,i)}(),r.close(),u.reset()}),g(),window.addEventListener("resize",g)})();